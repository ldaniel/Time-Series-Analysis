---
title: "Exploração dos Modelos"
date: "Outubro de 2019"
---

```{r setup_evaluation, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.pos =  "h")
knitr::opts_knit$set(root.dir = "./")

# loading required libraries
library(dplyr)
library(zoo)
library(forecast)
library(lubridate)
library(readxl)
library(knitr)
```

```{r scripts_evaluation, include=FALSE}
# loading required steps before performing the analysis
source("../src/util/auxiliary_functions.R")
ClearEnvironment()
```

# Criando os datasets de séries temporais

## Carregando a base de dados processada

```{r data_load, echo=TRUE}
target_data <- readRDS('../data/processed/target_dataset.rds')

target_ts <- ts(target_data$Sales, 
                start = c(2005,1), 
                end = c(2010, 4), 
                frequency = 4)

summary(target_ts)
```

## Criando o conjunto de dados de treino e teste

```{r create_train_test_datasets, echo=TRUE, out.width='100%'}
# creating train and test sets ------------------------------------------------
GenerateTrainTestDatasets(target_ts,
                          c(2005, 1),
                          c(2009, 4),
                          c(2010, 1),
                          c(2010, 4))

train_ts <- readRDS('../data/processed/train_ts.rds')
test_ts  <- readRDS('../data/processed/test_ts.rds')

# plot of the training and testing temporal series
plot(train_ts, 
     xlab = "Tempo", 
     ylab = "Vendas", 
     xaxt = "n", 
     ylim = c(48000, 104000), 
     xlim = c(2005, 2011), 
     bty = "l")
axis(1, at = seq(2005, 2011, 1), labels = format(seq(2005, 2011, 1)))
lines(test_ts, bty = "l", col = "red")
box(lty = '1373', col = 'black')
```

*******************************************************************************

# Rodando os modelos lineares de séries temporais

Para executarmos todos os modelos lineares de séries temporais, utilizamos a função **GenerateLinearTimeSeriesModels** criada para rodar cada um dos modelos desejados, gravando os resultados no diretório do projeto **\\models** para uso futuro.

```
linear_consolidation <- GenerateLinearTimeSeriesModels(train_ts, test_ts)
```
```{r generating_linear_models, include=FALSE}
linear_consolidation <- GenerateLinearTimeSeriesModels(train_ts, test_ts)
```

Uma vez executada, a função retorna um preview com os resultados de MAPE para cada um dos modelos, mostrados a seguir.

```{r consolidated_linear_models_preview, echo=TRUE, out.width= '100%'}
kable(linear_consolidation)
```

## Analisando os resultados do modelo de Tendência Linear

```{r linear_time_series_model_1, echo=TRUE, out.width='100%'}
#to-do
```

*******************************************************************************

# Rodando os modelos de suavização exponencial de séries temporais

Para executarmos todos os modelos de suavização exponencial de séries temporais, utilizamos a função **GenerateExponentialsmoothingStateTimeSeriesModel** criada para rodar cada um dos modelos desejados, gravando os resultados no diretório do projeto **\\models** para uso futuro.

```
smoothing_consolidation <- GenerateExponentialsmoothingStateTimeSeriesModel(target_ts, train_ts, test_ts)
```
```{r generating_smoothing_models, include=FALSE}
smoothing_consolidation <- GenerateExponentialsmoothingStateTimeSeriesModel(target_ts, train_ts, test_ts)
```

Uma vez executada, a função retorna um preview com os resultados de MAPE para cada um dos modelos, mostrados a seguir.

```{r consolidated_smoothing_models_preview, echo=TRUE, out.width='100%'}
kable(smoothing_consolidation)
```

## Analisando os resultados do modelo de Tendência Linear

```{r smoothong_model_1, echo=TRUE, out.width='100%'}
#to-do
```

*******************************************************************************

# Considerações finais

To-do.
